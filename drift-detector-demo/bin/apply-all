#!/bin/bash

if [ ! -e ".cub-project" ]; then
  echo "No space prefix found. Run bin/install-base first."
  exit 1
fi

project=$(cat .cub-project)
env=${1:-dev}

echo "Applying all units in $project-$env to Kubernetes..."

# Apply namespace first
cub unit apply ns-$env --space $project-infra --yes

# Apply all app units
cub unit apply --space $project-$env --filter $project/app --yes

echo "All units applied to Kubernetes"